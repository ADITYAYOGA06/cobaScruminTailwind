<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Timeline</title>
    <link rel="stylesheet" href="../css/output.css">
    <link rel="icon" href="../assets/logo_scrumin.png">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css"
    />
    <link href="https://fonts.googleapis.com/css2?family=Inria+Sans:ital,wght@0,300;0,400;1,300;1,400&display=swap" rel="stylesheet">
</head>
<body class="bg-[#DEE5D4]">
    <!-- The wrapper of tabs -->
    <div class="drop-shadow-lg bg-[#DEE5D4]">
        <!-- Tab Buttons -->
        <div id="tab-buttons" class="flex justify-center bg-[#DEE5D4]">
            <a href="javascript:void(0)" onclick="changeTab(event, 0)" class="inline-block px-5 py-3 text-xs  text-blue-600 divide-y-4">Calendar
                <hr class="border mt-2 rounded-lg">
            </a>
            <a href="javascript:void(0)" onclick="changeTab(event, 1)" class="inline-block px-5 py-3 text-xs  text-blue-600 divide-y-4">Board
                <hr class="border mt-2 rounded-lg">
            </a>
        </div>

        <!-- Tab Panels -->
        <div id="tab-panels" class="px-8 py-6 w-full m-auto">
            <div class="hidden">
                <h1 class="text-2xl text-red-500">Tab 2 Content</h1>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam, doloremque.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam, doloremque.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam, doloremque.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam, doloremque.</p>
            </div>

            <div class="flex flex-row gap-1">
                <!-- KIRI -->
                <div class="flex flex-row w-7/12 bg-blue-100 pl-8 pr-6 gap-4">
                    <!-- Bagian Backlog -->
                    <div class="flex flex-col w-44">
                        <!-- Tulisan backlog dan button -->
                        <div class="flex flex-row w-full justify-between mt-2">
                            <h1 class="flex text-[10px] font-black my-auto ">To do</h1>
                        </div>
          
                        <div class="mt-2 bg-white rounded-lg">
                            <!-- List backlog -->
                            <div class="flex flex-col px-4 p-3" id="backlogsCotainer" ondrop="drop(event)" ondragover="allowDrop(event)">
                                <div class="flex flex-row w-full mx-auto h-8 bg-slate-100 rounded-md my-2" id="task1" ondragstart="dragStart(event)">
                                   <h1 class="backlog-item flex my-auto ml-2 text-[10px] w-full hover:cursor-pointer">Tes</h1>
                                </div>
                            </div>
                        </div>
                    </div>
          
                    <!-- Sprint -->
                    <div class="" id="sprint-container">
                        <div class="flex flex-col w-44 mx-auto bg-white rounded-md my-3">
                            <div class="flex flex-row w-full justify-between mt-2">
                                <h1 class="flex text-[10px] font-black ml-8 my-auto" id="judul-sprint">Doing</h1>
                            </div>
                            <div id="sprintBacklogContainer" class="flex flex-col p-4" id="sprint1" ondrop="drop(event)" ondragover="allowDrop(event)">
                                <div class="flex flex-row w-full mx-auto h-8 bg-slate-100 rounded-md my-2" id="task1"  ondragstart="dragStart(event)">
                                    <h1 class="backlog-item flex my-auto ml-2 text-[10px] w-full hover:cursor-pointer">Tes</h1>
                                </div>
                            
                            <!-- Ini Tempat untuk Drop Backlog yaaa.. -->
                            </div>
                        </div>            
                    </div>

                    <!-- Complete -->
                    <div class="" id="sprint-container">
                        <div class="flex flex-col w-44 mx-auto bg-white rounded-md my-3">
                            <div class="flex flex-row w-full justify-between mt-2">
                                <h1 class="flex text-[10px] font-black ml-8 my-auto" id="judul-sprint">Done</h1>
                            </div>
                            <div id="sprintBacklogContainer" class="flex flex-col p-4" id="sprint1" ondrop="drop(event)" ondragover="allowDrop(event)">
                                <div class="flex flex-row w-full mx-auto h-8 bg-slate-100 rounded-md my-2" id="task1"  ondragstart="dragStart(event)">
                                    <h1 class="backlog-item flex my-auto ml-2 text-[10px] w-full hover:cursor-pointer">Tes</h1>
                                </div>
                            
                            <!-- Ini Tempat untuk Drop Backlog yaaa.. -->
                            </div>
                        </div>            
                    </div>
                </div>

                <!-- KANAN -->
                <div class="flex h-[440px] bg-slate-600 w-5/12">
                    <h1>Tes</h1>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

<script>
    // Awal kode untuk draggable
    let draggedItem = null

    function dragStart(event) {
        // event.dataTransfer.setData('text/plain', event.target.id);
        draggedItem = event.target
    }

    function allowDrop(event) {
        event.preventDefault();
    }

    function drop(event) {
        event.preventDefault();
        // const taskId = event.dataTransfer.getData('text/plain');
        // const taskElement = document.getElementById(taskId);
        const destinationId = event.currentTarget.id;
        const destinationElement = document.getElementById(destinationId);
        event.currentTarget.appendChild(draggedItem);
        console.log(event.currentTarget.dataset.sprintid, draggedItem.dataset.backlogid)
        fetch(`${window.location.origin}/project/${projectId}/planning/insert-backlog-to-sprint`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                "backlogId": draggedItem.dataset.backlogid,
                "sprintId": event.currentTarget.dataset.sprintid
            })
            })
            .then((response) => response.json())
            .then((data) => {
            if (data.status === `error`) {
                alert(data.errors)
                console.log(data)
                return
            }
            location.reload()
            })
            .catch((error) => {
            console.log(error);
            });
    }
    // Akhir kode untuk draggable
    
    function changeTab(event, index) {
        var tabButtons = document.getElementById('tab-buttons').children;
        var tabPanels = document.getElementById('tab-panels').children;

        // Remove the active utility classes from all tabs (bg-white, text-blue-600)
        // And hide all tab content (with the "hidden" utility)
        for (var i = 0; i < tabButtons.length; i++) {
            tabButtons[i].classList.remove('border-2');
            tabPanels[i].classList.add('hidden');
        }

        // Add the active utility classes to the currently active tab (bg-white, text-blue-600)
        // And show the current tab content (remove the "hidden" utility)
        tabButtons[index].classList.remove('text-white');
        tabButtons[index].getElementsByTagName('hr').remove;
        tabPanels[index].classList.remove('hidden');
    }
</script>